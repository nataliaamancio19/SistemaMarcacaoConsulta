<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:decorate xmlns="http://www.w3.org/1999/xhtml"
             xmlns:h="http://xmlns.jcp.org/jsf/html"
             xmlns:p="http://primefaces.org/ui"
             xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
             template="template.xhtml"
             xmlns:f="http://xmlns.jcp.org/jsf/core">
   
  <h:form id="consulta">
            <p:growl id="growl" autoUpdate="true" globalOnly="true" showDetail="true" life="4000" severity="info, warn"/>
        <p:fieldset legend="Consulta">
           <h:panelGrid columns="2" cellpadding="5">
            
            <p:outputLabel for="medico" value="Médico:" />
            <p:selectOneMenu id="medico" converter="medicoConverter" value="#{consultaBean.consulta.medico}">
                   <f:selectItems value="#{medicoBean.listar()}" var="medico" itemValue="#{medico}" itemLabel="#{medico.nome}"  />
            </p:selectOneMenu>
           
            <p:outputLabel for="paciente" value="Paciente:" />
            <p:inputText id="paciente" value="#{consultaBean.consulta.paciente}" />

            <p:outputLabel for="dataHorario" value="Data e Hora:" />
            <p:calendar id="dataHorario" value="#{consultaBean.consulta.dataHora}" required="true" pattern="yyyy/MM/dd HH:mm:ss" />
         
            </h:panelGrid>  
            
                <p:commandButton action="#{consultaBean.salvar()}" value="Salvar" ajax="false" update="@form" 
                                 title="Salvar" icon="ui-icon-check" validateClient="false"/>
                <p:commandButton action="editarConsulta" immediate="true" value="Editar" />

        </p:fieldset>
    </h:form>
    <h:form id="convidadoListar"> 
        <p:fieldset legend="Consutas cadastradas">
            <p:dataTable value="#{consultaBean.listar()}"  var="consultaAtual">
                <p:column headerText="Opções">
                    <p:commandButton id="deletar" value="Deletar" action="#{consultaBean.excluir(consultaAtual)}" immediate="true"  update="@form"></p:commandButton>
                </p:column>                
                <p:column headerText="Nome" >
                    <h:outputText value="#{consultaAtual.medico.nome}"></h:outputText>
                </p:column> 
                <p:column headerText="Paciente" >
                    <h:outputText value="#{consultaAtual.paciente.nome}"></h:outputText>
                </p:column> 
                 <p:column headerText="Data e Hora" >
                    <h:outputText value="#{consultaAtual.dataHora}"></h:outputText>
                </p:column> 
            </p:dataTable>
        </p:fieldset>
    </h:form>    
    
    
    
    
    
    
    
</ui:decorate>
